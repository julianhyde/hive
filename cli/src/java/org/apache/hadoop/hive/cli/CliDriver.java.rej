***************
*** 137,155 ****
  
        // shell_cmd = "/bin/bash -c \'" + shell_cmd + "\'";
        try {
-         Process executor = Runtime.getRuntime().exec(shell_cmd);
-         StreamPrinter outPrinter = new StreamPrinter(executor.getInputStream(), null, ss.out);
-         StreamPrinter errPrinter = new StreamPrinter(executor.getErrorStream(), null, ss.err);
- 
-         outPrinter.start();
-         errPrinter.start();
- 
-         ret = executor.waitFor();
- 
-         // wait for stream threads to finish
-         outPrinter.join();
-         errPrinter.join();
- 
          if (ret != 0) {
            console.printError("Command failed with exit code = " + ret);
          }
--- 137,144 ----
  
        // shell_cmd = "/bin/bash -c \'" + shell_cmd + "\'";
        try {
+         ShellCmdExecutor executor = new ShellCmdExecutor(shell_cmd, ss.out, ss.err);
+         ret = executor.execute();
          if (ret != 0) {
            console.printError("Command failed with exit code = " + ret);
          }
